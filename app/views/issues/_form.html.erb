<%= form_for @issue do |f| %>

<% if @issue.errors.any? %>
    <div id="error_explanation">
      <h2>
        <%= pluralize(@issue.errors.count, "error") %> prohibited this issue from being saved:
      </h2>
      <ul>
        <% @issue.errors.full_messages.each do |msg| %>
          <li>
            <%= msg %>
          </li>
          <% end %>
      </ul>
    </div>
    <% end %>
    
  <div>
    <%= f.label :name %>
    <%= f.text_field :issue_name %>
  </div>
  <div>
    <%= f.label :date_started %>
    <%= f.date_field :date_started %>
  </div>
  <div>
    <%= f.label :notes %>
    <%= f.text_area :notes, size: '60x6' %>
  </div>
  <div class="field">
    <%= f.label "Please select all relevant symptoms" %><br />
    <%= f.collection_check_boxes :symptom_ids, Symptom.all, :id, :symptom_name do |b| %>
      <%= b.label %>
      <%= b.check_box %><br />
    <% end %>
  </div>
  <div class="field">
    <%= f.label "Please add any medications related to this issue." %><br />
    <%= f.fields_for :medications do |medications_fields| %> 
      <%= medications_fields.label :medication_name %>
      <%= medications_fields.text_field :medication_name %><br />
   
      <%= medications_fields.fields_for :issue_medications do |issue_medications_fields| %>
    
        <%= issue_medications_fields.label :first_taken %>
        <%= issue_medications_fields.date_field :first_taken %><br />
        
        <%= issue_medications_fields.label :dosage %>
        <%= issue_medications_fields.number_field :dosage %><br />
        
        <%= issue_medications_fields.label :frequency %>
        <%= issue_medications_fields.text_field :frequency %><br />
                
      <% end %>
    <% end %>
  </div>

  <div>
    <%= f.submit %>
  </div>
<% end %>